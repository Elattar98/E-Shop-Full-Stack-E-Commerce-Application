 r=0,u=e[1];const o=e;for(;u-r>1e-4;){const e=w(t(o));y(h(o),h(n(e)))-.02<1e-4?r=o[1]:u=o[1],o[1]=(u+r)/2}return w(t([...o]))}(e,t,n)}function w(e){return e.map((e=>e<0?0:e>1?1:e))}function x(e){const[t,n,r]=e;return t>=-1e-4&&t<=1.0001&&n>=-1e-4&&n<=1.0001&&r>=-1e-4&&r<=1.0001}function F(e){const[t,n,r]=e;let u=[Math.max(t,0),n,r],o=m(u);return o[0]<1e-6&&(o=[0,0,0]),o[0]>.999999&&(o=[1,0,0]),u=v(u),u=d(u),u=f(u),x(u)?[w(u),!0]:[g(o,(e=>f(e=d(e=v(e=h(e))))),(e=>m(e=b(e=p(e=c(e)))))),!1]}function M(e){const[t,n,r]=e,u=[Math.max(t,0),n,r%360];let o=u;return o[0]<1e-6&&(o=[0,0,0]),o[0]>.999999&&(o=[1,0,0]),o=h(o),o=v(o),o=d(o),o=f(o),x(o)?[w(o),!0]:[g(u,(e=>f(e=d(e=v(e=h(e))))),(e=>m(e=b(e=p(e=c(e)))))),!1]}function k(e){const[t,n,r]=e;let u=[Math.max(t,0),n,r],o=m(u);return o[0]<1e-6&&(o=[0,0,0]),o[0]>.999999&&(o=[1,0,0]),u=v(u),u=l(u),u=s(u),x(u)?w(u).map((e=>Math.round(255*e))):g(o,(e=>s(e=l(e=v(e=h(e))))),(e=>m(e=b(e=i(e=a(e)))))).map((e=>Math.round(255*e)))}function C(e){const[t,n,r]=e,u=[Math.max(t,0),n,r%360];let o=u;return o[0]<1e-6&&(o=[0,0,0]),o[0]>.999999&&(o=[1,0,0]),o=h(o),o=v(o),o=l(o),o=s(o),x(o)?w(o).map((e=>Math.round(255*e))):g(u,(e=>s(e=l(e=v(e=h(e))))),(e=>m(e=b(e=i(e=a(e)))))).map((e=>Math.round(255*e)))}function P(e){const t=e.value.toLowerCase(),n=e.nodes.slice().filter((e=>"comment"!==e.type&&"space"!==e.type));let r=null;if("oklab"===t?r=A(n):"oklch"===t&&(r=O(n)),!r)return;e.value="rgb",function(e,t,n){if(!t||!n)return;if(e.value="rgba",t.value=",",t.before="",!function(e){if(!e||"word"!==e.type)return!1;if(!$(e))return!1;const t=u.default.unit(e.value);if(!t)return!1;return!!t.number}(n))return;const r=u.default.unit(n.value);if(!r)return;"%"===r.unit&&(r.number=String(parseFloat(r.number)/100),n.value=String(r.number))}(e,r.slash,r.alpha);const[o,a,s]=B(r),[i,l,c]=E(r),f=("oklab"===t?k:C)([i.number,l.number,c.number].map((e=>parseFloat(e))));e.nodes.splice(e.nodes.indexOf(o)+1,0,{sourceIndex:0,sourceEndIndex:1,value:",",type:"div",before:"",after:""}),e.nodes.splice(e.nodes.indexOf(a)+1,0,{sourceIndex:0,sourceEndIndex:1,value:",",type:"div",before:"",after:""}),j(e.nodes,o,{...o,value:String(f[0])}),j(e.nodes,a,{...a,value:String(f[1])}),j(e.nodes,s,{...s,value:String(f[2])})}function L(e){if(!e||"word"!==e.type)return!1;if(!$(e))return!1;const t=u.default.unit(e.value);return!!t&&("%"===t.unit||""===t.unit)}function I(e){return e&&"function"===e.type&&"calc"===e.value.toLowerCase()}function N(e){return e&&"function"===e.type&&"var"===e.value.toLowerCase()}function S(e){return e&&"div"===e.type&&"/"===e.value}function O(e){if(!L(e[0]))return null;if(!L(e[1]))return null;if(!function(e){if(!e||"word"!==e.type)return!1;if(!$(e))return!1;const t=u.default.unit(e.value);if(!t)return!1;const n=t.unit.toLowerCase();return!!t.number&&("deg"===n||"grad"===n||"rad"===n||"turn"===n||""===n)}(e[2]))return null;const t={l:u.default.unit(e[0].value),lNode:e[0],c:u.default.unit(e[1].value),cNode:e[1],h:u.default.unit(e[2].value),hNode:e[2]};return function(e){switch(e.unit.toLowerCase()){case"deg":return void(e.unit="");case"rad":return e.unit="",void(e.number=(180*parseFloat(e.number)/Math.PI).toString());case"grad":return e.unit="",void(e.number=(.9*parseFloat(e.number)).toString());case"turn":e.unit="",e.number=(360*parseFloat(e.